---
created: 2023-09-22
number headings: first-level 2, start-at 1, max 6, 1.1-
title: 设计目标
author: 罗潇
cssclass: wideTable
first-level: 1
pdf-filename: 基础平台2.0设计目标
platform: true
category: 架构设计
---

# 2. **设计目标与原则**  
  
## 2.1. **设计目标**  
  
**降低技术难度，节省人力成本，<mark style="background: #6082C5A6;">增强代码安全性 (1) </mark> **：基础平台的主要目的是能够让开发人员快速的开发出复杂的业务功能，让其专注业务开发，由有平台来封装技术细节，缩短项目周期。封装技术细节时强制插入安全规范，增加代码安全性。<mark style="background: #6082C5A6;">在基础平台设计中，代码的安全性被视为一项核心目标。为了确保开发人员在开发复杂业务功能时遵循最佳的安全实践。</mark>   
{ .annotate }  
  
1. **封装技术安全细节**：平台自动为开发人员处理诸如输入验证、SQL注入防护、跨站脚本攻击(XSS)防范等安全细节，使开发人员可以更专注于业务逻辑，而不是安全实现。  
    **强制安全规范**：平台内部集成了自动化安全检查工具，确保在开发过程中自动检查和遵循已定义的安全规范。  
    **安全培训和文档**：提供针对性的安全培训和文档，确保开发人员了解并遵循平台推荐的安全策略。  
    **定期审计与更新**：平台定期进行安全审计，确保代码库始终与当前的安全标准相匹配。  
  
**提供公共服务**：系统管理，用户管理，网关转发，登录认证等业务功能在各产品大体相同，平台提供统一功能，并预留功能扩展点，避免各产品重复开发，浪费人力。  
  
**平台代码和产品代码隔离**：平台代码以编译版本发布，产品二次开发时直接引用，避免平台和产品代码混合。  
  
**支持低资源消耗或高性能支撑部署方式**：平台部署时需兼顾资源消耗和性能支撑，灵活切换部署方式。  
  
<mark style="background: #6082C5A6;">**升级和自我进化** (1) ：为保持平台的竞争力和适应不断变化的技术与业务环境，基础平台设计中强调其持续升级与自我进化的能力。</mark>  
{ .annotate }  
  
1. 自动化升级机制：平台应具备升级和更新的能力，并允许用户选择是否应用这些更新。  
    模块化设计：通过模块化设计，可以独立更新特定组件或功能，而不会对整体平台造成大的冲击，这有助于快速适应技术或业务的新需求。  
    扩展性：平台设计应该有足够的灵活性，允许添加新功能、技术或工具，使其能够随着时间的推移而进化。  
    持续集成与持续交付 (CI/CD)：实施CI/CD流程，确保每次代码更改都经过质量和安全性检查，并且可以快速、平稳地部署到生产环境。  
  
### 2.1.1. **关键功能**  
  
**网关服务：**API服务路由，统一身份认证和鉴权，支持密码，OAuth，Cas，OTP，<mark style="background: #6082C5A6;">二次认证</mark> 等多种认证方式 。  
  
**系统服务：**提供IP，SSH，时间，防火墙，升级，公告等常用系统管理功能。涉及操作系统交互都是用ITR接口。  
  
**用户服务：**用户和权限管理。  
  
**消息模块：**提供嵌入式或高性能两种模式，灵活切换，自由选择。  
  
**公共代码：**封装常用非业务功能，例如：工具类，Web，ORM，消息，缓存，RPC，邮件，短信，配置等，降低框架使用难度，提升开发效率。  
  
### 2.1.2. **关键质量属性**  
  
* 最低硬件配置  
  
CPU：4核  
  
内存：2G  
  
* 最低硬件性能  
  
身份认证：不小于100次/秒  
  
路由转发：不小于100次/秒  
  
操作鉴权：不小于100次/秒  
  
规范化：严格按照先设计后开发原则，设计优于开发，每个功能必须出详细设计文档  
  
易用性：方便好用是开发平台基本要求，每个功能力争做到配置化开发，考虑后期扩展，预留扩展点和事件  
  
接口化：公共服务面向接口编程，按插件接口设计和开发  
  
可伸缩：支持业务团队水平扩容服务，满足业务的增长  
  
<mark style="background: #6082C5A6;">容错性 (1) ：选择几项我们能做到的. </mark>  
{ .annotate }  
  
1. 系统在部分组件失败的情况下仍能继续运行。举几个例子：  
冗余：通过多副本或备份组件来确保在某些部分出错时，系统仍然可以继续运行。  
快速故障检测与恢复：系统能够快速地检测到失败并立即启动备份。  
数据完整性：即使在故障情况下，系统也应确保数据的完整性和一致性。  
自我修复：系统在检测到问题后能够自动采取措施修复它，无需人工干预。  
  
<mark style="background: #6082C5A6;">稳定性 (1) ：选择几项我们能做到的. </mark>  
{ .annotate }  
  
1. 系统在不同条件下都能可靠地运行，而不会意外崩溃或出现错误。包括：  
健壮性：系统能够处理各种边缘情况、异常输入或突然的负载增加。  
性能稳定性：即使在高负载条件下，系统也能够提供一致的响应时间和处理速度。  
版本向后兼容性：新版本的系统或软件能够与旧版本中的数据和接口兼容。  
资源泄漏检测：确保系统在长时间运行下不会由于资源泄漏而变慢或崩溃。  
预防死锁：在多任务或多线程环境中，确保系统组件之间不会由于资源争夺而陷入死锁。  
  
### 2.1.3. **部署方式**  
  
基础平台用户产品二次开发，需要灵活部署方式适应各种需求。  
  
**低资源部署：**资源受限情况下，合并服务与组件，以较低资源进行部署，架构简单，部署便捷，业务流转快。  
  
**高性能部署：**服务与组件采用单独部署，充分利用资源，服务间不强制依赖，独立运行，不存在单点问题，支撑大数据和高并发。  
  
**容器化部署：** 满足上云需求，服务和组件都支持镜像部署。  
  
### 2.1.4. **设计约束**  
  
由于部门架构的要求，基础平台遵循以下技术约束：  
  
1. 服务间交互  
  
为了服务高内聚低耦合，减少服务内部变化导致外部影响，服务间交互都采用Rest接口，禁止直接连接服务数据库或中间件获取数据，并且服务接口需考虑后期维护和扩展，尽量做到接口不改或少改。  
  
2. 操作系统交互  
  
系统服务存在大量与操作系统交互操作，例如：IP，DHCP，时间，防火墙，只要ITR系统平台已提供的功能，都需通过ITR完成与操作系统交互，严禁支持使用操作系统命令。  
  
<mark style="background: #6082C5A6;">数据存储约束: </mark>  
  
所有敏感数据（例如：用户信息、密码、密钥等）都应加密存储。  
及时升级过时或已知存在安全漏洞的数据库版本。  
  
<mark style="background: #6082C5A6;">第三方库和组件: </mark>  
  
任何使用的第三方库或组件必须来自于已知的、受信任的来源。  
必须定期更新第三方库和组件，以确保它们是最新的，并修复了已知的安全漏洞。  
  
<mark style="background: #6082C5A6;">环境隔离: </mark>  
  
开发、测试和生产环境应完全隔离。开发和测试环境不应有生产数据的访问权限。  
  
<mark style="background: #6082C5A6;">代码质量约束: </mark>  
  
所有的代码提交都应经过代码审查，并遵循已定义的编码规范和最佳实践。  
应进行持续集成与持续部署，确保代码质量和自动化测试的执行。  
  
## 2.2. **设计原则**  
  
* **基础功能和业务功能隔离**  
  
基础功能是业务无关，为服务赋能，独立工程开发，即插即用。  
  
业务功能是产品间共性功能，例如：网关，系统管理，用户管理，资产管理。各服务需边界明确，高内聚低耦合，通过接口交互，数据库独立设计。  
  
* **配置与扩展**  
  
平台做为二次开发底座，交付每个功能都要考虑产品使用时的个性化需求，做到易使用，易扩展。功能设计预先考虑变化点，设计相关配置项，提前预留相关扩展点。公共服务需遵循插件化设计原则，以适应功能不满足需求时的复写扩展。  
  
* <mark style="background: #6082C5A6;">**安全第一**</mark>  
  
数据传输, 存储遵循最佳设计实践, 不设计底层新轮子, 遵循标准和安全编码和设计的规范建议.    
  
* <mark style="background: #6082C5A6;">**遵循开放标准**</mark>  
  
采用开放的技术标准和协议，以确保平台的互操作性和未来的技术整合。  
  
* <mark style="background: #6082C5A6;">**模块化与解耦**</mark>  
  
独立地进化、测试、部署和更新它们。  
  
* <mark style="background: #6082C5A6;">**可观察性**</mark>  
  
设计的时候需要充分考虑快速定位问题、性能瓶颈和其他潜在问题指标可被便捷地观察。  
  
## 2.3. **技术选型**  
  
* 后端基于 Spring Boot、Spring security、MyBatis-Plus，前端采用 AngularJS。前后端框架都在业界广泛使用，受众广，易使用，社区活跃，文档全面，二次开发时能做到无缝连接。  
  
* API服务网关改为自研，引入Spring cloud gateway。Spring Cloud Gateway是基于WebFlux框架实现的，而WebFlux框架底层则使用了高性能的Reactor模式通信框架Netty，并提供动态路由、限流、均衡负载等高级特性。  
  
* 为减轻对Kafka依赖，引入ActiveMQ作为嵌入式MQ。Apache ActiveMQ是一款老牌消息中间件，稳定性高，功能丰富，作为低资源部署时Message Broker。  
