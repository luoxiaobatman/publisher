---
created: 2023-09-20
number headings: first-level 2, start-at 1, max 6, 1.1-
title: 基础平台1.0资产管理
author: 罗潇
cssclass: wideTable
first-level: 1
pdf-filename: 基础平台1.0资产管理
platform: true
category: 概要设计
---

### 1.1.1 **资源管理**

#### 1.1.1.1 **资源组管理**

##### 1.1.1.1.1**功能描述**

1.资源组管理，作为资源管理下的二级菜单功能模块呈现，为资源的上级节点属性，一个资源组下面会有多个资源，包含名称、简称等基本属性；

2.支持拖拽方式移动资源组树；

3.支持动态扩展属性，例如系统类型、备注等通过动态方式扩展。

##### 1.1.1.1.2**功能设计**

1.资源组树形结构展示，树形展示资源组名称，层级数不做限制；

2.新增/修改界面支持动态属性扩展，动态属性支持文本框、下拉框、多选和文本域等四种方式的呈现。

3.资源组和默认分组作为基础数据。不允许修改和删除。

##### 1.1.1.1.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps51.jpg) 

#### 1.1.1.2 **系统资源管理**

##### 1.1.1.2.1**功能描述**

1.系统资源管理，包含基础属性维护管理；

2.支持导入导出、批量删除等功能。

##### 1.1.1.2.2**功能设计**

###### 1.1.1.2.2.1**列表**

1. 系统资源列表，支持列表头点击排序，默认按修改时间倒序排序；

2. 支持针对单个资源进行帐号管理操作。

###### 1.1.1.2.2.2**新增/修改**

1. 系统资源新增、修改页面中，按规范进行数据输入校验；

2. 资源类型的选择必须要选择到具体的版本号；

3. 新增资源时，录入的管理帐号、普通帐号等的密码不需要遵从资源口令策略，修改的时候下拉选择康帐号/普通帐号；

4. 资源指定协议时，带出默认端口号，且可编辑；

5. 新增/修改界面动态加载扩展属性；

6. 新增/修改系统资源数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.2.2.3**导入/导出**

1. 导入的系统资源数据已存在则做系统资源修改操作、导入的系统资源数据不存在则做系统资源新增操作；

2. 资源的导入先对于数据进行校验，校验不通过的数据直接返回，成功的数据才会一次性导入；

3. 新增或修改系统资源数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.2.2.4**删除**

1. 资源进行删除时，删除资源、资源下帐号，同时已授权该资源的用户将无法使用资源下所有帐号。

2. 删除系统资源数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

3. 支持批量删除资源。

##### 1.1.1.2.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps52.jpg) 

#### 1.1.1.3 **应用资源管理**

##### 1.1.1.3.1**功能描述**

1. 应用资源管理，指维护管理应用系统基础属性，包括资源名称、简称、URL地址、协议、IP地址等；

2. 支持导入导出、批量删除等功能；

3. 支持标准协议的录入。

##### 1.1.1.3.2**功能设计**

###### 1.1.1.3.2.1**列表**

1. 应用资源列表，除操作栏支持列表头点击排序，默认按修改时间倒序排序；

2. 支持对单个资源的帐号管理操作。

###### 1.1.1.3.2.2**新增/修改**

1. 必填项：资源名称、应用系统名称拼音、资源组、资源类型、通讯协议、资源IP；

2. 每个输入项必须遵照输入校验规范；

3. 新增/修改界面动态加载扩展属性；

4. 新增/修改应用资源数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.3.2.3**导入/导出**

1. 导入的应用资源数据已存在则做应用资源修改操作、导入的应用资源数据不存在则做应用资源新增操作；

2. 新增或修改应用资源数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.3.2.4**删除**

1. 应用资源进行删除时，删除应用资源、对应应用资源下帐号，同时已授权该资源的用户将无法使用资源下所有帐号。

2. 删除应用资源数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

3. 支持批量删除。

##### 1.1.1.3.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps53.jpg) 

#### 1.1.1.4 **帐号管理**

##### 1.1.1.4.1**功能描述**

针对资源（包括系统资源和应用资源）下面的帐号进行维护操作管理，资源帐号俗称为帐号。

##### 1.1.1.4.2**功能设计**

###### 1.1.1.4.2.1**列表**

1. 功能按钮包括：【增加】、【删除】、【导入】、【导出】、【解锁/锁定】；

2. 展示内容：帐号名称、资源名称、资源IP、资源组、资源类型（具体到版本）、帐号类型、状态；

3. 列表支持资源名称、帐号名称、资源IP等的单文本模糊查询；

4. 帐号列表，除操作栏支持列表头点击排序，默认按修改时间倒序排序。

###### 1.1.1.4.2.2**新增/修改**

1. 必填项：资源、帐号名称、类型、密码等；

2. 每个输入项必须遵照输入校验规范；

3. 新增/修改界面动态加载扩展属性；

4. 新增/修改帐号数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.4.2.3**删除**

1. 帐号进行删除时，删除帐号，同时已授权该资源的用户将无法使用该帐号；

2. 删除帐号数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作；

3. 支持批量删除。

##### 1.1.1.4.3**导入/导出**

1. 导入的帐号数据已存在则做帐号修改操作、导入的帐号数据不存在则做应用帐号新增操作；

2. 新增或修改帐号数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

##### 1.1.1.4.4**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps54.jpg) 

#### 1.1.1.5 **登录协议管理**

##### 1.1.1.5.1**功能描述**

登录协议包括SSH、TELNET、SFTP、RDP、ORACLE、TERADATA、VNC、MSSQL、FTP、RLOGIN、SCP、MYSQL、DB2、POSTGRESQL、SYBASE、INFORMIX、HTTPS、HTTP、TOKEN、PEIVATE，登录协议与资源相关联，一个资源可关联多个登录协议。

##### 1.1.1.5.2**功能设计**

###### 1.1.1.5.2.1**查询**

1. 在新增资源的时候，可选中多个登录协议与对应的默认端口，默认端口可修改；

2. 在修改资源的时候，可以对选中的登录协议与端口进行修改。

###### 1.1.1.5.2.2**新增/修改**

1. 支持新增协议名称、默认端口等；

2. 协议名称不能重名；

3. 必填项协议名称、端口等；

4. 新增/修改登录协议数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.5.2.3**删除**

1. 登录协议进行删除时，删除协议；

2. 删除登录协议数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作；

3. 支持批量删除，但是内置的协议不允许删除。

##### 1.1.1.5.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps55.jpg) 

#### 1.1.1.6 **资源口令策略**

##### 1.1.1.6.1**功能描述**

1. 资源口令策略，为资源对应的帐号密码设置口令策略强度，每个资源下面的帐号密码都需遵守该口令策略；

2. 内置默认资源口令策略，资源新增时默认该口令策略；

3. 支持自定义资源口令策略，资源新增编辑时可以自定义选择对应的口令策略。

##### 1.1.1.6.2**功能设计**

###### 1.1.1.6.2.1**列表**

1. 支持策略名称的模糊查询；

2. 默认修改时间倒序排序。

###### 1.1.1.6.2.2**新增/编辑**

1. 每个输入项必须遵照输入校验规范；

2. 新增/修改口令策略数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.6.2.3**内置弱口令校验**

1. 资源口令策略编辑界面，提供是否启用内置弱口令策略的开关；

2. 对于启用内置弱口令策略后，在资源帐号密码校验时增加其校验判断机制。

###### 1.1.1.6.2.4**删除**

1. 口令策略进行删除时，删除口令策略，同时绑定该口令策略的资源对应口令策略失效，用内置默认口令策略；

2. 删除口令策略数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作；

3. 支持批量删除。

##### 1.1.1.6.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps56.jpg) 

#### 1.1.1.7 **帐号核查**

##### 1.1.1.7.1**功能描述**

帐号核查模块分为三部分核查结果、核查任务、帐号过滤器。作为资源管理的二级功能，帐号核查可采取目标资源（Linux、windows,数据库等）帐号信息。通过核查任务创建帐号核查任务，任务类型分为立即执行、周期执行、定时执行，可通过指定资源组、资源、资源类型对制定资源进行帐号核查。帐号过滤器中，可通过资源类型、资源两个维度对不需要采集帐号进行配置（这一阶段帐号过滤器暂未实现，下一阶段补充进该功能）。在核查结果中，左侧为资源组，右侧为所有核查结果以资源为维度进行统计的最新结果。

##### 1.1.1.7.2**核查流程**

帐号核查流程分为两部分，一部分是帐号采集，在目标设备上采集帐号信息，第二部分是帐号核查，通过设备、堡垒机日志对帐号进行核查。

###### 1.1.1.7.2.1**帐号采集流程图**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps57.png) 

流程描述：

1. 根据核查任务中资源进行帐号采集

2. 核查结果中根据核查策略进行过滤，去除不需要采集的帐号

3. 通过命令通道获取目标设备登陆日志

4. 根据目标设备、基础平台、堡垒机日志，检索资源帐号

5. 按照采集帐号类型定义对帐号进行归类

6. 将过滤后，核查完成的帐号采集到基础平台

###### 1.1.1.7.2.2**帐号核查流程图**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps58.png) 

流程描述：

1. 根据资源类型判断是否采集目标设备登陆日志；

2. 判断目标设备日志有不通过基础平台、堡垒机登陆，是为异常登陆帐号；

3. 根据日志信息判断帐号无登陆日志，是为僵尸帐号；

4. 日志信息中，帐号超过90天未登陆为长时间未登陆帐号；

5. 在基础平台中未授权的帐号信息，为孤儿帐号；

6. 在基础平台侧帐号收录为管理类型的帐号为管理帐号，否则为普通帐号。

##### 1.1.1.7.3**功能设计**

|   |   |   |   |   |   |
|---|---|---|---|---|---|
|**组件**|**一级功能**|**二级功能**|**三级功能**|**功能描述**|**备注**|
||资源管理|帐号核查|核查结果|核查结果列表、导出、加锁、解锁、删除||
|核查任务|核查任务列表，增加、删除、修改、执行||
|核查策略|业务操作的增加、修改、删除、查询|暂未实现|

###### 1.1.1.7.3.1**核查结果**

1.通过核查策略配置，根据资源类型、资源进行对采集上来的帐号进行过滤，取并集，即都要过滤，策略中配置了的帐号信息，不予录入系统；

2.帐号核查策略：包括根据设备上采集的帐号登录时间、帐号状态进行帐号核查；根据设备上采集的帐号登陆时间、帐号状态+日志（设备主动外发的日志+堡垒机日志）进行核查；僵尸帐号（从来没登录过）/长时间未登录（90天未登录过）/孤儿帐号（未进行主从授权）帐号判断标准，帐号核查判断标准，明确是使用4A（包含堡垒机）上的日志进行判断，帐号核查里去掉“绕行帐号”的判断依据；

3.帐号状态的判断、核查结果的判断，需要分系统版本处理，windows、linux主机和数据库等，暂支持windows主机、linux主机、unix主机、oracle、mysql、sqlserver、db2、informix、postgresql等

4.锁定、解锁：

修改当前选中的帐号状态，同时同步堡垒机，当目标设备支持锁定帐号时同时同步到目标资源。功能可参考帐号管理锁定、解锁。

5.删除：

没有删除功能

7.确认新增：

1. 帐号核查时，从目标设备采集到的帐号取消直接入库操作。

2. 在帐号核查结果列表增加 “确认新增” 列 ，对于存在于目标设备而基础平台不存在的帐号可点击“确认新增”按钮，弹出帐号修改框，填写作为基础平台正常帐号所需要填写的内容，点击保存，即可将目标帐号保存到基础平台。在目标设备和基础平台均有的帐号，该列为空，不显示“确认新增”。

3. 在列表上方增加按钮“确认新增”，弹出帐号修改框，不回显帐号和资源名称，填写其他属性，点击保存，即可将帐号批量入库。对于已经存在于基础平台的帐号，在帐号批量入库的时候会入库失败。

4. 由于帐号状态是基础平台帐号的属性，采集到的帐号没有入库时，没有该属性，该项为空。

5. 锁定/解锁帐号是针对平台内已有的帐号进行操作的，当选中未入库的帐号时，操作失败。

6. 此处密码说明：密码不作为必填项，同时不受口令策略限制。

###### 1.1.1.7.3.2**核查任务**

以任务方式进行帐号采集，帐号核查功能包括核查任务和核查策略，采集任务分为即时任务、定时任务和周期任务；

增加帐号过滤机制，可根据资源类型，默认一些常见的资源内置帐号，作为过滤对象，不再被采集到基础平台上，同时过滤帐号可手动增删---本阶段暂不实现；

核查任务结果中，对已采集的帐号提供手动过滤功能，过滤时，如该帐号已进行授权，则给出“该帐号已授权，无法执行该操作”等类似提示；

采集的帐号不会存入基础平台，需要在帐号核查结果页面手动确认新增，每个帐号仅可新增一次，新增之后不会改变本次核查的结果。

###### 1.1.1.7.3.3**核查策略**

1、核查策略中配置的帐号为不需要采集的帐号，可通过资源、资源类型两个维度对不需要采集的帐号进行配置。

2、资源类型配置核查策略，一级大类下配置了不需要核查的帐号，则这整个大类下配置的帐号都将不被采集到基础平台侧。

3、资源配置核查策略，对资源进行帐号配置，资源进行帐号核查时，配置的帐号将不被采集。

4、当资源与资源类型都配置了核查策略时，则帐号核查过滤的帐号为两种维度配置的并集。例如资源A（Linux）配置了不采集帐号sshd,资源类型linux配置了不采集帐号sshr，增采集资源A时将同时不采集帐号sshd和sshr。

##### 1.1.1.7.4**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps59.jpg) 

#### 1.1.1.8 **扩展属性管理**

##### 1.1.1.8.1**功能描述**

扩展属性管理，以支持系统资源、应用资源、资源组、资源帐号等管理模块，动态扩展属性，支持文本框、文本域、单选框、下拉框、时间框、多选框等多种形式的数据呈现。

##### 1.1.1.8.2**功能设计**

###### 1.1.1.8.2.1**列表**

1.默认修改时间倒序排序；

2.支持字段名称等模糊查询。

###### 1.1.1.8.2.2**新增/修改**

界面参考：

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps60.jpg) 

1. 每个输入项必须遵照输入校验规范；

2. 新增/修改扩展属性数据，发送消息到消息中心，以便下层执行组件接收消息进行日志存储等操作；

3. 仅支持是否为必填的控制。

###### 1.1.1.8.2.3**删除**

1. 删除扩展属性数据，发送消息到消息中心，以便下层执行组件接收消息进行日志存储等操作；

2. 支持批量删除。

##### 1.1.1.8.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps61.jpg) 

#### 1.1.1.9 **数据同步**

##### 1.1.1.9.1**功能描述**

资源管理相关数据变更，数据同步服务组件通过消息中心获取消息调用资源管理提供的API接口封装数据同步至堡垒机、ASCG等。

##### 1.1.1.9.2**功能设计**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps62.png) 

由数据同步组件订阅数据变更事件，事件中的信息能满足数据同步需求情况下，数据同步服务调用后端服务的原子API，否则数据同步服务需要根据事件中的对象ID，调用后端服务的原则API把获取到的数据进行封装后，按照能力组件的API主动向能力组件推送数据。
