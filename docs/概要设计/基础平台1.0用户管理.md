---
created: 2023-09-20
number headings: first-level 2, start-at 1, max 6, 1.1-
title: 基础平台1.0用户管理
author: 罗潇
cssclass: wideTable
first-level: 1
pdf-filename: 基础平台1.0用户管理
platform: true
category: 概要设计
---

### 1.1.1 **用户管理**

#### 1.1.1.1 **组织管理**

##### 1.1.1.1.1**功能描述**

组织管理，为用户的上级节点属性，一个组织机构下面会有多个用户，组织机构作为树形结构呈现，包含组织机构名称、简称等基本属性；

支持拖拽方式移动组织机构树；

支持导入导出、批量删除等功能；

支持动态扩展属性，例如组织性质等属性通过动态方式扩展。

##### 1.1.1.1.2**功能设计**

###### 1.1.1.1.2.1**组织机构列表**

1.列表显示顺序：名称、名称全路径、简称、操作。

2.列表查询条件为名称、名称全路径的模糊查询。

3.列表头可排序的字段是：名称、名称全路径。可点击名称、简称的标题处进行升序和降序查询数据。默认排序为修改时间倒序。

###### 1.1.1.1.2.2**组织机构新增**

1.组织机构新增必填项父节点名称、名称。校验规则为产品标准输入输出校验规则。

2.新增的组织机构在当前父组织机构下唯一。

3.新增组织机构页面动态加载扩展属性。

4.新增组织机构数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步等操作。

###### 1.1.1.1.2.3**组织机构修改**

1.组织机构修改名称属性时，同时修改子节点名称全路径。

2.修改的组织机构名称在当前父组织机构下唯一。

3.修改组织机构页面动态加载扩展属性。

4.修改组织机构数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步等操作。

###### 1.1.1.1.2.4**组织机构拖拽**

1.拖拽组织机构修改当前组织机构及其子节点的名称全路径；

2.当前组织机构在拖拽到的父组织机构下唯一；

3.用户对应的组织id值不会发生变化。

###### 1.1.1.1.2.5**组织机构删除**

1.组织机构列表页面删除按钮删除组织机构：组织机构批量删除按钮，组织机构列表可以勾选要删除的组织机构信息。删除组织机构时会校验组织机构下是否有用户，如果存在用户，那么当前删除操作所选中的组织机构都不会被删除。当不存在用户的时候，可以级联删除当前组织机构及其子节点的组织机构。

2.删除组织机构数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步等操作。

3.组织机构和默认分组不允许修改和删除。

###### 1.1.1.1.2.6**组织机构导入模板下载**

根据组织机构表结构动态生成组织机构导入模板，表头新增扩展属性（动态扩展），表字段顺序同组织机构列表显示一致。

###### 1.1.1.1.2.7**组织机构导入**

1.使用名称全路径确定唯一的组织机构，如果组织机构存在，则修改组织机构属性，如果不存在，就做新增组织机构操作；

2.导入组织机构数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步等操作；

3.导入和导出对应必填项的格式说明保持风格一致，统一以(必填)标注；

4.支持导出的数据模板，当没有增加新的扩展属性时，可以直接导入；

5.批量导入时，先检测数据的合规性，如果存在就覆盖修改，如果不存在做新增数据处理；

6.组织机构导入或新增、修改时，同级不能同名。

###### 1.1.1.1.2.8**组织机构导出**

导出的字段为名称全路径，类型，编号，地域，以及组织机构的扩展属性等。

##### 1.1.1.1.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps42.jpg) 

#### 1.1.1.2 **用户管理**

##### 1.1.1.2.1**功能****描述**

实现平台登录帐号管理，包括增删改、锁定解锁和认证方式配置、导入导出等。

##### 1.1.1.2.2**功能****设计**

###### 1.1.1.2.2.1**用户列表**

1.列表查询条件为用户、真实姓名、手机号模糊查询，以及状态、认证方式查询。

2.列表头可排序的字段是：用户、真实姓名、组织机构（组织全路径）、手机号、认证方式、状态。可点击上面字段的标题处进行升序和降序查询数据。默认排序为修改时间倒序。

###### 1.1.1.2.2.2**用户新增**

1.用户新增必填项真实姓名、用户、密码、确认密码、组织机构、开始时间、结束时间、认证方式。校验规则为产品标准输输入输出校验规则。

2.新增的用户名唯一。

3.新增用户页面动态加载扩展属性。

4.新增用户数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

5.新增用户时，可选择绑定系统角色，且支持多选。

6.新增用户时，组织机构、认证方式、开始时间和结束时间有默认值，分别为默认组、静态密码、当前时间和配置项配置的默认时间。

###### 1.1.1.2.2.3**用户修改**

1.用户名不能修改、开始时间不能修改。

2.密码与确认密码相同。

3.结束时间必须大于开始时间。

4.修改用户页面动态加载扩展属性。

5.修改用户数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

6.修改用户时，可选择绑定系统角色，且支持多选。

###### 1.1.1.2.2.4**用户复制**

1.用户列表页面用户数据行操作栏点击复制按钮，复制用户基本属性(组织机构、有效期、认证方式、角色)到复制用户页面，实现新建用户的功能。

2.新增用户数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.2.2.5**用户删除**

1.用户列表页面选中需要删除的用户，然后点击删除按钮即可删除用户。

2.删除用户为逻辑删除，只是将数据库中用户状态改为del。

3.删除用户数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步等操作。

###### 1.1.1.2.2.6**用户锁定解锁**

1.用户列表页面选中需要锁定\解锁的用户，然后点击锁定或者解锁。当 用户被锁定的时候，用户是不能够登录的。

2.用户锁定：管理员用户列表页面锁定用户，记录锁定原因为：管理员锁定；用户登录密码错误次数过多锁定，记录锁定原因为：密码错误次数过多；用户有效期过期锁定，记录锁定原因为：用户有效期过期。

3.用户解锁：管理员用户列表页面解锁用户，清除锁定原因；用户由于密码错误次数过多造成的锁定，可以在登录配置中配置自动解锁时间，超过自动解锁时间用户登录成功就会解锁成功并且清除锁定原因。

4.修改用户数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

5.用户锁定的逻辑处理，应是在CAS获取用户时实现的。

6.用户登录时，应有用户到期提醒的提示信息，默认内置7天提醒。

###### 1.1.1.2.2.7**用户导入模板下载**

根据用户表结构动态生成用户导入模板，表头新增扩展属性，表字段顺 序同用户列表显示一致。

###### 1.1.1.2.2.8**用户导入**

1.导入的用户数据已存在则做用户修改操作、导入的用户数据不存在则做用户新增操作。

2.新增或修改用户数据，发送消息到消息中心，以便下层执行组件接收消息进行数据同步、日志存储等操作。

###### 1.1.1.2.2.9**用户导出**

导出的字段名称为用户、真实姓名、密码、组织机构全路径、手机号、邮箱、状态、认证方式、开始时间、结束时间、角色以及用户扩展属性。

###### 1.1.1.2.2.10**用户绑定系统角色**

点击用户列表操作栏的绑定角色功能按钮，实现选择绑定系统角色，且支持多选。

##### 1.1.1.2.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps43.jpg) 

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps44.jpg) 

#### 1.1.1.3 **OTP管理**

##### 1.1.1.3.1**功能****描述**

为用户提供动态口令码（OTP）的录入维护操作，可以作为用户的认证方式。

##### 1.1.1.3.2**功能****设计**

###### 1.1.1.3.2.1**列表**

1.OTP管理列表页面需要分别展示出坚石诚信和飞天的OTP令牌信息；

2.每个算法列表都会展示OTP令牌相关的信息，包含令牌编号，令牌秘钥，关联用户，描述字段信息；

3.列表都可以通过点击令牌编号字段的标题栏实现当前列数据升序降序排序功能。列表默认排序为修改时间降序；

4.列表都有令牌编号、令牌秘钥、以及关联用户这几个字段作为模糊查询条件。

###### 1.1.1.3.2.2**国际/国密OTP新增**

1. 国密算法OTP通过导入界面导入文件的方式进行新增；

2. 国际算法OTP录入令牌编号和令牌秘钥，都是必填项，按照标准输入输出校验。

###### 1.1.1.3.2.3**删除**

1. 删除令牌，仅能删除未绑定用户的令牌；

2. 列表支持批量删除操作。

###### 1.1.1.3.2.4**OTP绑定用户**

关联用户功能，一个令牌最多绑定一个用户，但是一个用户可以同时绑定一个国密算法OTP令牌和一个国际算法OTP令牌。

##### 1.1.1.3.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps45.jpg) 

#### 1.1.1.4 **用户核查**

##### 1.1.1.4.1**功能****描述**

用户核查模块作为用户管理的二级功能，用户核查根据用户信息判断用户的帐号类型生命状态。为后台定时任务，每天凌晨一点执行。

##### 1.1.1.4.2**功能****设计**

###### 1.1.1.4.2.1**核查定时任务**

1.以后台定时任务方式进行用户核查，前端不再有核查任务的界面呈现；

2.核查类型包含：僵尸用户(未登录用户)、长时间未登录用户(90天未登录过)、过期用户、异常登录用户（密码错误次数过多被锁定用户）、孤儿用户（未授权资源的用户）；

3.对于核查类型做优先级判定：过期用户-->孤儿用户-->僵尸用户-->长时间未登录用户-->异常登录用户。

###### 1.1.1.4.2.2**核查结果**

1. 按组织机构维度展示用户核查结果的状态信息；

2. 左侧组织机构，右侧对应的组织机构下核查的用户信息，展示内容包括：用户、真实姓名、组织机构、手机号、状态、核查结果、核查时间；

3. 针对用户核查结果列表，可导出、删除，同时可以对用户进行锁定/解锁等操作。

##### 1.1.1.4.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps46.jpg) 

#### 1.1.1.5 **用户口令****策略**

##### 1.1.1.5.1**功能****描述**

用户口令策略提供平台用户通用的口令策略，如密码长度限制、密码复杂度限制、密码有效期控制、密码过期处理、历史密码比对等。

##### 1.1.1.5.2**功能****设计**

###### 1.1.1.5.2.1**密码长度限制**

最小密码长度大于等于8且小于30，最大密码长度大于8且小于等于30，最大密码长度大于最小密码长度。

###### 1.1.1.5.2.2**密码复杂度限制**

密码包含小写字母、密码包含大写字母、密码包含特殊字符、密码包含 数字。

密码必须包含两种及以上复杂度。

###### 1.1.1.5.2.3**密码周期限制**

密码有效期：大于0，小于等于365.

密码到期提醒时间：密码到期前多少天提醒，大于0，小于等于60.

密码到期提醒时间必须小于密码有效期。

密码到期处理方式：管理员用户强制修改密码，普通用户两种方式，一 种是强制修改密码，另外一种是进行用户锁定，给出锁定原因：密码过期锁定。

###### 1.1.1.5.2.4**密码历史比对**

密码不得重复次数：修改的密码不能和配置次数之内历史记录密码相同，次数必须大于0，小于等于20。

###### 1.1.1.5.2.5**密码错误登录锁定**

允许密码错误次数：错误次数超过配置的错误次数密码数，将用户锁定，锁定原因密码错误次数过多，次数必须大于0，小于等于20.

###### 1.1.1.5.2.6**内置弱口令校验**

1. 用户口令策略编辑界面，提供是否启用内置弱口令策略的开关；

2. 对于启用内置弱口令策略后，在用户密码校验时增加其校验判断机制。

##### 1.1.1.5.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps47.jpg) 

#### 1.1.1.6 **扩展属性管理**

##### 1.1.1.6.1**功能****描述**

扩展属性管理，以支持用户管理、组织机构等管理模块，动态扩展属性，支持文本框、文本域、单选框、下拉框、时间框、多选框等多种形式的数据呈现。

##### 1.1.1.6.2**功能****设计**

###### 1.1.1.6.2.1**列表**

1. 默认修改时间倒序排序；

2. 支持字段名称等模糊查询。

###### 1.1.1.6.2.2**新增/修改**

界面参考：

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps48.jpg) 

1.每个输入项必须遵照输入校验规范；

2.新增/修改扩展属性数据，发送消息到消息中心，以便下层执行组件接收消息进行日志存储等操作；

3.界面中仅支持是否为启用和是否必填。

###### 1.1.1.6.2.3**删除**

1.删除扩展属性数据，发送消息到消息中心，以便下层执行组件接收消息进行日志存储等操作；

2.支持批量删除。

##### 1.1.1.6.3**数据结构**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps49.jpg) 

#### 1.1.1.7 **数据同步**

##### 1.1.1.7.1**功能描述**

用户管理相关数据变更，数据同步服务组件通过消息中心获取消息调用资源管理提供的API接口封装数据同步至堡垒机、ASCG等。

##### 1.1.1.7.2**功能设计**

![](file:////private/var/folders/rl/gchkw9l93p149mmyj8t07w280000gn/T/com.kingsoft.wpsoffice.mac.global/wps-xiaoluo/ksohtml//wps50.png) 

由数据同步组件订阅数据变更事件，事件中的信息能满足数据同步需求情况下，数据同步服务调用后端服务的原子API，否则数据同步服务需要根据事件中的对象ID，调用后端服务的原则API把获取到的数据进行封装后，按照能力组件的API主动向能力组件推送数据。
